<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RENFE Train Tracking</title>
</head>
<body>
    <!--TRAIN-->
    <div class="sidebar-pane" id="train">
      <div class="close-button"><span class="fa fa-close" onclick="javascript: sidebar.close()"></span>
      </div>
      <h1 data-i18n="train_title">ğŸš† Trens RENFE</h1>
      <p style="text-align:justify; margin-right:5px;" data-i18n="train_description">Visualitza les posicions en temps real dels trens RENFE a Espanya. Les dades provenen directament de l'API oficial de RENFE a travÃ©s de GTFS-RT.</p>

      <!-- Real-time train controls -->
      <div style="margin-bottom: 15px;">
        <h3 style="margin-bottom: 10px; color: #333;" data-i18n="train_realtime_tracking">ğŸ“¡ Seguiment en temps real</h3>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
          <button id="start-realtime-btn" onclick="startRealtimeTrains()" style="background:#2a2a2a; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px;">
            <i class="fa fa-play"></i> <span data-i18n="train_start_tracking">Inicia seguiment</span>
          </button>
          <button id="stop-realtime-btn" onclick="stopRealtimeTrains()" style="background:#cc0000; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px; display: none;">
            <i class="fa fa-stop"></i> <span data-i18n="train_stop_tracking">Atura seguiment</span>
          </button>
        </div>

        <!-- Legend toggle -->
        <button id="legend-btn" onclick="toggleTrainLegend()" style="background:#007acc; color:white; padding:8px 12px; border:none; border-radius:3px; cursor:pointer; font-size: 12px; display: none; margin-right: 10px;">
          <i class="fa fa-map"></i> <span data-i18n="train_legend">ğŸ¨ Llegenda de lÃ­nies</span>
        </button>
      </div>

      <!-- Status display -->
      <div id="realtime-status" style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #ddd;">
        <span data-i18n="train_status">Status:</span> <span data-i18n="train_status_inactive">Inactiu</span>
      </div>

      <!-- Manual data entry section -->
      <div id="manual-data-entry" style="display: none; margin-bottom: 15px;">
        <h4 style="margin-bottom: 10px; color: #333;" data-i18n="train_manual_data">ğŸ“ Introduir Dades Manualment</h4>
        <p style="font-size: 12px; color: #666; margin-bottom: 10px;">
          Si les dades automÃ tiques no funcionen, pots copiar-les manualment des de:
        </p>
        <button onclick="openRenfeJson()" style="background:#666; color:white; padding:6px 10px; border:none; border-radius:3px; cursor:pointer; font-size: 12px; margin-right: 5px;">
          <i class="fa fa-external-link"></i> <span data-i18n="train_open_json">Obre JSON RENFE</span>
        </button>
        <button onclick="copyRenfeUrl()" style="background:#666; color:white; padding:6px 10px; border:none; border-radius:3px; cursor:pointer; font-size: 12px;">
          <i class="fa fa-copy"></i> <span data-i18n="train_copy_url">Copia URL</span>
        </button>
        <div style="margin-top: 10px;">
          <textarea id="manual-json-data" placeholder="Enganxa aquÃ­ les dades JSON de RENFE..." style="width: 100%; height: 100px; padding: 8px; border: 1px solid #ccc; border-radius: 3px; font-family: monospace; font-size: 11px;" data-i18n="train_paste_json"></textarea>
        </div>
        <div style="margin-top: 10px;">
          <button onclick="processManualJsonData()" style="background:#007acc; color:white; padding:8px 12px; border:none; border-radius:3px; cursor:pointer;">
            <i class="fa fa-play"></i> <span data-i18n="train_process_data">Processar Dades Reals</span>
          </button>
          <button onclick="clearTextarea()" style="background:#666; color:white; padding:8px 12px; border:none; border-radius:3px; cursor:pointer;">
            <i class="fa fa-trash"></i> <span data-i18n="train_clear">Neteja</span>
          </button>
        </div>
        <div id="json-status" style="margin-top: 10px; font-size: 12px; color: #666;">
          <span data-i18n="train_json_status">Status: Preparat per enganxar dades</span>
        </div>
      </div>

      <!-- Instructions -->
      <div style="background: #e8f4f8; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #b8daff;">
        <h4 style="margin-top: 0; color: #004085;" data-i18n="train_how_it_works">ğŸ“– Com funciona</h4>
        <ol style="font-size: 13px; color: #004085; margin: 0; padding-left: 20px;">
          <li data-i18n="train_step1">Inicia el seguiment: Prem "Inicia seguiment" per carregar trens RENFE en temps real</li>
          <li data-i18n="train_step2">Visualitza al mapa: Els trens apareixeran com marcadors amb el codi de la lÃ­nia</li>
          <li data-i18n="train_step3">Clica als marcadors: ObtÃ© informaciÃ³ detallada sobre cada tren</li>
          <li data-i18n="train_step4">Llegenda: Mostra la llegenda per veure les lÃ­nies i colors</li>
          <li data-i18n="train_step5">Atura quan vulguis: Prem "Atura seguiment" per netejar el mapa</li>
        </ol>
      </div>

      <!-- Additional options -->
      <div style="margin-bottom: 15px;">
        <button onclick="showManualDataEntry()" style="background:#f0f0f0; color:#333; padding:8px 12px; border:1px solid #ccc; border-radius:3px; cursor:pointer; font-size: 12px;">
          <i class="fa fa-cog"></i> <span data-i18n="train_advanced_options">Opcions avanÃ§ades</span>
        </button>
        <button onclick="testSampleData()" style="background:#f0f0f0; color:#333; padding:8px 12px; border:1px solid #ccc; border-radius:3px; cursor:pointer; font-size: 12px; margin-left: 5px;">
          <i class="fa fa-flask"></i> <span data-i18n="train_sample_data">Prova amb dades d'exemple</span>
        </button>
      </div>

      <!-- Coverage info -->
      <div style="background: #fff3cd; padding: 10px; border-radius: 3px; border: 1px solid #ffeaa7; font-size: 12px;">
        <strong data-i18n="train_coverage">â„¹ï¸ Cobertura:</strong> Aquest servei mostra trens RENFE de tot Espanya, incloent Rodalies, CercanÃ­as, AVE, Alvia, Avant i trens regionals. Les dades s'actualitzen cada 30 segons.
      </div>

      <br><hr width="90%">

      <!-- Help section -->
      <h3 style="color: #333;" data-i18n="train_help_title"><i class="fa fa-question-circle"></i> Ajuda</h3>
      <p style="text-align:justify; margin-right:5px; font-size: 13px;" data-i18n="train_help_text">
        Aquest panell et permet visualitzar la posiciÃ³ en temps real dels trens RENFE a Espanya. Les dades provenen de l'API oficial de RENFE (GTFS-RT) i s'actualitzen automÃ ticament. Si tens problemes amb la cÃ rrega automÃ tica, pots utilitzar l'opciÃ³ de dades manuals.
      </p>
      <center><button style="background:#2a2a2a; color:white; padding:5px;" class="fa fa-support"
          onclick="copyJsonInstructions()" data-i18n="train_copy_instructions"> ğŸ“‹ Copiar instruccions</button></center>
    </div>
</body>
</html>
