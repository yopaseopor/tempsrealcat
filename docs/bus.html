<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autobusos TMB</title>
</head>
<body>
    <!--BUS-->
    <div class="sidebar-pane" id="bus">
      <div class="close-button"><span class="fa fa-close" onclick="javascript: sidebar.close()"></span>
      </div>
      <h1 data-i18n="bus_title">üöå Autobusos TMB</h1>
      <p style="text-align:justify; margin-right:5px;" data-i18n="bus_description">Visualitza les posicions en temps real dels autobusos TMB a Barcelona. Les dades provenen directament de l'API de TMB.</p>

      <!-- Real-time bus controls -->
      <div style="margin-bottom: 15px;">
        <h3 style="margin-bottom: 10px; color: #333;" data-i18n="bus_realtime_tracking">üì° Seguiment en temps real</h3>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
          <button id="start-bus-realtime-btn" onclick="startRealtimeBus()" style="background:#2a2a2a; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px;">
            <i class="fa fa-play"></i> <span data-i18n="bus_start_tracking">Inicia seguiment</span>
          </button>
          <button id="stop-bus-realtime-btn" onclick="stopRealtimeBus()" style="background:#cc0000; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px; display: none;">
            <i class="fa fa-stop"></i> <span data-i18n="bus_stop_tracking">Atura seguiment</span>
          </button>
        </div>

        <!-- Legend toggle -->
        <button id="bus-legend-btn" onclick="toggleBusLegend()" style="background:#007acc; color:white; padding:8px 12px; border:none; border-radius:3px; cursor:pointer; font-size: 12px; display: none; margin-right: 10px;">
          <i class="fa fa-map"></i> <span data-i18n="bus_legend">üé® Llegenda de l√≠nies</span>
        </button>
      </div>

      <!-- Status display -->
      <div id="bus-realtime-status" style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #ddd;">
        <span data-i18n="bus_status">Status:</span> <span data-i18n="bus_status_inactive">Inactiu</span>
      </div>

      <!-- Manual data entry section -->
      <div id="bus-manual-data-entry" style="display: none; margin-bottom: 15px;">
        <h4 style="margin-bottom: 10px; color: #333;" data-i18n="bus_manual_data">üìù Introduir Dades Manualment</h4>
        <p style="font-size: 12px; color: #666; margin-bottom: 10px;">
          Si les dades autom√†tiques no funcionen, pots copiar-les manualment des de:
        </p>
        <button onclick="openBusJson()" style="background:#666; color:white; padding:6px 10px; border:none; border-radius:3px; cursor:pointer; font-size: 12px; margin-right: 5px;">
          <i class="fa fa-external-link"></i> <span data-i18n="bus_open_api">Obre API TMB</span>
        </button>
        <button onclick="copyBusUrl()" style="background:#666; color:white; padding:6px 10px; border:none; border-radius:3px; cursor:pointer; font-size: 12px;">
          <i class="fa fa-copy"></i> <span data-i18n="bus_copy_url">Copia URL</span>
        </button>
        <div style="margin-top: 10px;">
          <textarea id="bus-manual-json-data" placeholder="Enganxa aqu√≠ les dades JSON de TMB..." style="width: 100%; height: 100px; padding: 8px; border: 1px solid #ccc; border-radius: 3px; font-family: monospace; font-size: 11px;" data-i18n="bus_paste_json"></textarea>
        </div>
        <div style="margin-top: 10px;">
          <button onclick="processBusManualJsonData()" style="background:#007acc; color:white; padding:8px 12px; border:none; border-radius:3px; cursor:pointer;">
            <i class="fa fa-play"></i> <span data-i18n="bus_process_data">Processar Dades</span>
          </button>
          <button onclick="clearBusTextarea()" style="background:#666; color:white; padding:8px 12px; border:none; border-radius:3px; cursor:pointer;">
            <i class="fa fa-trash"></i> <span data-i18n="bus_clear">Neteja</span>
          </button>
        </div>
        <div id="bus-json-status" style="margin-top: 10px; font-size: 12px; color: #666;">
          <span data-i18n="bus_json_status">Status: Preparat per enganxar dades</span>
        </div>
      </div>

      <!-- Instructions -->
      <div style="background: #e8f4f8; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #b8daff;">
        <h4 style="margin-top: 0; color: #004085;" data-i18n="bus_how_it_works">üìñ Com funciona</h4>
        <ol style="font-size: 13px; color: #004085; margin: 0; padding-left: 20px;">
          <li data-i18n="bus_step1">Inicia el seguiment: Prem "Inicia seguiment" per carregar autobusos TMB en temps real</li>
          <li data-i18n="bus_step2">Visualitza al mapa: Els autobusos apareixeran com marcadors amb el codi de la l√≠nia</li>
          <li data-i18n="bus_step3">Clica als marcadors: Obt√© informaci√≥ detallada sobre cada autob√∫s</li>
          <li data-i18n="bus_step4">Llegenda: Mostra la llegenda per veure les l√≠nies i colors</li>
          <li data-i18n="bus_step5">Atura quan vulguis: Prem "Atura seguiment" per netejar el mapa</li>
        </ol>
      </div>

      <!-- Additional options -->
      <div style="margin-bottom: 15px;">
        <button onclick="showBusDataEntry()" style="background:#f0f0f0; color:#333; padding:8px 12px; border:1px solid #ccc; border-radius:3px; cursor:pointer; font-size: 12px;">
          <i class="fa fa-cog"></i> <span data-i18n="bus_advanced_options">Opcions avan√ßades</span>
        </button>
        <button onclick="testBusSampleData()" style="background:#f0f0f0; color:#333; padding:8px 12px; border:1px solid #ccc; border-radius:3px; cursor:pointer; font-size: 12px; margin-left: 5px;">
          <i class="fa fa-flask"></i> <span data-i18n="bus_sample_data">Prova amb dades d'exemple</span>
        </button>
      </div>

      <!-- Coverage info -->
      <div style="background: #fff3cd; padding: 10px; border-radius: 3px; border: 1px solid #ffeaa7; font-size: 12px;">
        <strong data-i18n="bus_coverage">‚ÑπÔ∏è Cobertura:</strong> Aquest servei mostra autobusos TMB de Barcelona, incloent l√≠nies regulars, Aerobus i Nitbus. Les dades s'actualitzen cada 30 segons.
      </div>

      <br><hr width="90%">

      <!-- Help section -->
      <h3 style="color: #333;" data-i18n="bus_help_title"><i class="fa fa-question-circle"></i> Ajuda</h3>
      <p style="text-align:justify; margin-right:5px; font-size: 13px;" data-i18n="bus_help_text">
        Aquest panell et permet visualitzar la posici√≥ en temps real dels autobusos TMB a Barcelona. Les dades provenen de l'API oficial de TMB i s'actualitzen autom√†ticament. Si tens problemes amb la c√†rrega autom√†tica, pots utilitzar l'opci√≥ de dades manuals.
      </p>
      <center><button style="background:#2a2a2a; color:white; padding:5px;" class="fa fa-support"
          onclick="copyBusInstructions()" data-i18n="bus_copy_instructions"> üìã Copiar instruccions</button></center>
    </div>
</body>
</html>
