<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="traffic_page_title">Trnsit Catalunya</title>
</head>
<body>
    <!--TRAFFIC-->
    <div class="sidebar-pane" id="traffic">
      <div class="close-button"><span class="fa fa-close" onclick="javascript: sidebar.close()"></span>
      </div>
      <h1 data-i18n="traffic_main_title"> Trnsit Catalunya</h1>
      <p style="text-align:justify; margin-right:5px;" data-i18n="traffic_main_description">
        Informaci贸 del trnsit en temps real a Catalunya. Les dades provenen directament del Servei Catal de Trnsit (SCT).
      </p>

      <!-- Real-time traffic controls -->
      <div style="margin-bottom: 15px;">
        <h3 style="margin-bottom: 10px; color: #333;" data-i18n="traffic_realtime_title"> Informaci贸 en temps real</h3>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
          <button id="load-traffic-btn" onclick="loadTrafficData()" style="background:#2a2a2a; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px;">
            <i class="fa fa-sync"></i> <span data-i18n="traffic_load_data">Carregar dades</span>
          </button>
          <button id="load-cameras-btn" onclick="loadTrafficCameras()" style="background:#17a2b8; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px;">
            <i class="fa fa-video"></i> <span data-i18n="traffic_cameras">Cmeres de trnsit</span>
          </button>
          <button id="load-andorra-cameras-btn" onclick="loadAndorraCameras()" style="background:#e83e8c; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px;">
            <i class="fa fa-video"></i> <span data-i18n="traffic_andorra_cameras">Cmeres d'Andorra</span>
          </button>
          <button id="load-panels-btn" onclick="loadTrafficPanels()" style="background:#6f42c1; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px;">
            <i class="fa fa-info-circle"></i> <span data-i18n="traffic_panels">Panells informatius</span>
          </button>
          <button id="clear-traffic-btn" onclick="clearTrafficData()" style="background:#cc0000; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-size: 14px; display: none;">
            <i class="fa fa-trash"></i> <span data-i18n="traffic_clear_map">Neteja mapa</span>
          </button>
        </div>

        <!-- Filter options -->
        <div style="margin-top: 10px;">
          <label style="font-size: 12px; color: #666;" data-i18n="traffic_filter_label">Filtrar per tipus:</label>
          <select id="traffic-filter" onchange="filterTrafficIncidents()" style="margin-left: 10px; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
            <option value="all" data-i18n="traffic_filter_all">Tots els incidents</option>
            <option value="maintenance" data-i18n="traffic_filter_maintenance">Obres</option>
            <option value="accident" data-i18n="traffic_filter_accident">Accidents</option>
            <option value="congestion" data-i18n="traffic_filter_congestion">Congesti贸</option>
            <option value="closure" data-i18n="traffic_filter_closure">Tancaments</option>
          </select>
        </div>
      </div>

      <!-- Status display -->
      <div id="traffic-status" style="background: #f8f9fa; padding: 10px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #ddd;">
        <span data-i18n="traffic_status_label">Status:</span> <span id="status-text" data-i18n="traffic_status_ready">Preparat per carregar dades</span>
      </div>

      <!-- Traffic table -->
      <div id="traffic-table-section" style="display: none; margin-bottom: 20px;">
        <h4 style="margin-bottom: 10px; color: #333;" data-i18n="traffic_table_title"> Taula d'incidents</h4>
        <div id="table-container">
          <!-- Table will be populated here -->
        </div>
      </div>

      <!-- Traffic incidents cards -->
      <div id="traffic-cards-section" style="display: none; margin-bottom: 15px;">
        <h4 style="margin-bottom: 10px; color: #333;" data-i18n="traffic_cards_title"> Targetes d'incidents</h4>
        <div id="cards-container" style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; padding: 10px;">
          <!-- Cards will be populated here -->
        </div>
      </div>

      <!-- Traffic cameras section -->
      <div id="traffic-cameras-section" style="display: none; margin-bottom: 15px;">
        <h4 style="margin-bottom: 10px; color: #333;" data-i18n="traffic_cameras_title"> Cmeres de trnsit</h4>
        <div id="cameras-container" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; padding: 10px;">
          <!-- Camera thumbnails will be populated here -->
        </div>
      </div>

      <!-- Traffic panels section -->
      <div id="traffic-panels-section" style="display: none; margin-bottom: 15px;">
        <h4 style="margin-bottom: 10px; color: #333;" data-i18n="traffic_panels_title"> Panells informatius</h4>
        <div style="margin-bottom: 10px;">
          <label style="font-size: 12px; color: #666;" data-i18n="traffic_select_road">Seleccionar carretera:</label>
          <select id="panel-road-select" onchange="loadPanelsForSelectedRoad()" style="margin-left: 10px; padding: 5px; border: 1px solid #ccc; border-radius: 3px;">
            <option value="" data-i18n="traffic_choose_road">Tria una carretera...</option>
            <option value="A-2">A-2 (17 panells)</option>
            <option value="AP-7">AP-7 (1 panell)</option>
            <option value="B-20">B-20 (1 panell)</option>
            <option value="B-23">B-23 (2 panells)</option>
            <option value="B-30">B-30 (4 panells)</option>
            <option value="C-16">C-16 (2 panells)</option>
            <option value="C-31">C-31 (5 panells)</option>
            <option value="C-32S">C-32S (1 panell)</option>
            <option value="C-33">C-33 (1 panell)</option>
            <option value="C-58">C-58 (9 panells)</option>
          </select>
          <button id="refresh-panels-btn" onclick="refreshCurrentPanels()" style="margin-left: 10px; background:#6c757d; color:white; padding:5px 10px; border:none; border-radius:3px; cursor:pointer; font-size: 12px;">
            <i class="fa fa-refresh"></i> <span data-i18n="traffic_refresh_panels">Actualitzar</span>
          </button>
        </div>
        <div id="panels-container" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; padding: 10px;">
          <!-- Panel information will be populated here -->
        </div>
      </div>

      <!-- Instructions -->
      <div style="background: #e8f4f8; padding: 15px; border-radius: 5px; margin-bottom: 15px; border: 1px solid #b8daff;">
        <h4 style="margin-top: 0; color: #004085;" data-i18n="traffic_how_it_works"> Com funciona</h4>
        <ol style="font-size: 13px; color: #004085; margin: 0; padding-left: 20px;">
          <li data-i18n="traffic_instruction_load_data">Prem "Carregar dades" per obtenir informaci贸 del trnsit actual</li>
          <li data-i18n="traffic_instruction_cameras">Prem "Cmeres de trnsit" per veure les cmeres de Catalunya</li>
          <li data-i18n="traffic_instruction_andorra">Prem "Cmeres d'Andorra" per veure les cmeres d'Andorra</li>
          <li data-i18n="traffic_instruction_panels">Prem "Panells informatius" per veure els missatges dels panells de trnsit</li>
          <li data-i18n="traffic_instruction_markers">Els incidents apareixeran com marcadors al mapa</li>
          <li data-i18n="traffic_instruction_click_markers">Clica als marcadors per veure detalls de cada incident</li>
          <li data-i18n="traffic_instruction_filter">Utilitza el filtre per mostrar nom茅s certs tipus d'incidents</li>
          <li data-i18n="traffic_instruction_clear">Prem "Neteja mapa" per eliminar tots els marcadors</li>
        </ol>
      </div>

      <!-- Coverage info -->
      <div style="background: #fff3cd; padding: 10px; border-radius: 3px; border: 1px solid #ffeaa7; font-size: 12px;" data-i18n="traffic_coverage_info">
        <strong>癸 Cobertura:</strong> Aquest servei mostra informaci贸 del trnsit de Catalunya proporcionada pel Servei Catal de Trnsit (SCT). Les dades s'actualitzen regularment.
      </div>

      <br><hr width="90%">

      <!-- Help section -->
      <h3 style="color: #333;" data-i18n="traffic_help_title">Ajuda</h3>
      <p style="text-align:justify; margin-right:5px; font-size: 13px;" data-i18n="traffic_help_description">
        Aquest panell et permet visualitzar incidents de trnsit en temps real a Catalunya. Les dades provenen del Servei Catal de Trnsit (SCT) i inclouen obres, accidents, congestions i tancaments de carreteres.
      </p>
    </div>
</body>
<script src="assets/js/translations.js"></script>
<script src="assets/js/traffic.functions.js"></script>
</html>
